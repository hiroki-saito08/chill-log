import{l as $,q as Z,B as ee,o as r,f as c,b as e,u as a,h as k,s as M,A as z,C as q,x as te,a as u,w as b,t as l,F as w,z as E,d as g,g as y,v as D,y as Q,k as se,W as X,P as R,j as oe,n as ae,p as le,i as ie,D as ne}from"./app-b778bdf3.js";import{H as re,_ as ce}from"./Footer-1e938a63.js";import{_ as Y}from"./_plugin-vue_export-helper-c27b6911.js";import{T as de}from"./Toast-df579b81.js";/* empty css            */const ue={class:"share-wrapper"},_e=["href"],ve=["href"],pe={__name:"ShareMenu",setup(_){const s=$(!1),x=window.location.href,p=encodeURIComponent(x),C=()=>{s.value=!s.value,console.log(s.value)},P=async()=>{try{await navigator.clipboard.writeText(x),alert("Link copied!"),s.value=!1}catch(m){console.error("Copy failed:",m)}},i=async()=>{if(navigator.share)try{await navigator.share({title:"Check out this Chill Spot!",url:x})}catch(m){console.error("Share canceled or failed:",m)}else alert("Your browser does not support native sharing.");s.value=!1},T=$(null),U=m=>{T.value&&T.value.contains(m.target)||m.target.closest(".share-wrapper")||(s.value=!1)};return Z(()=>{document.addEventListener("click",U)}),ee(()=>{document.removeEventListener("click",U)}),(m,j)=>(r(),c("div",ue,[e("button",{class:"btn share-btn",onClick:C},"Share"),s.value?(r(),c("div",{key:0,class:"share-popup",ref_key:"popup",ref:T},[e("a",{href:`https://x.com/share?url=${a(p)}&text=Check out this chill spot!`,target:"_blank",rel:"noopener noreferrer",class:"share-link"},"X",8,_e),e("a",{href:`https://www.facebook.com/sharer/sharer.php?u=${a(p)}`,target:"_blank",rel:"noopener noreferrer",class:"share-link"},"Facebook",8,ve),e("button",{class:"share-link",onClick:P},"Copy Link"),e("button",{class:"share-link",onClick:i},"Native Share")],512)):k("",!0)]))}},me=Y(pe,[["__scopeId","data-v-9359d4d0"]]);const d=_=>(le("data-v-600d05e4"),_=_(),ie(),_),he=["content"],ge=["content"],fe=["content"],ye=["content"],be=d(()=>e("meta",{property:"og:type",content:"article"},null,-1)),we=["content"],ke={class:"post-detail"},xe={class:"container"},Ce={class:"section"},Se={class:"spot-header"},Ee={class:"category"},Re={class:"mb-4"},Te=["src"],Ue={class:"d-flex align-items-center gap-3 mb-4"},Ve=["src"],$e={class:"spot-meta"},Fe=d(()=>e("span",{class:"fw-bold"},"・ Address:",-1)),Me={key:0},De=d(()=>e("span",{class:"fw-bold"},"・ Recommended Time: ",-1)),Pe=d(()=>e("span",{class:"fw-bold"}," ・ description:",-1)),je={class:"buttons"},Ie={key:0,class:"text-end mt-3"},Le={key:1,class:"review-button-wrapper"},Ne={key:0,class:"modal-backdrop-custom"},Oe={class:"modal d-block",tabindex:"-1"},Ae={class:"modal-dialog modal-dialog-centered modal-lg"},Be={class:"modal-content"},He=d(()=>e("h5",{class:"modal-title"},"Edit Post",-1)),We={class:"modal-body"},ze={class:"form-container"},qe={class:"form-group"},Qe=d(()=>e("label",{for:"title"},"Title",-1)),Xe={class:"form-group"},Ye=d(()=>e("label",{for:"category"},"Category",-1)),Ge=["value"],Je={class:"form-group"},Ke=d(()=>e("label",{for:"location_name"},"Location (Address)",-1)),Ze={class:"address-container"},et={class:"form-group"},tt=d(()=>e("label",{class:"form-label mb-2"},"Recommended Visit Time",-1)),st={class:"d-flex flex-wrap gap-2"},ot=["value","id"],at=["for"],lt={class:"form-group"},it=d(()=>e("label",{for:"description"},"Description",-1)),nt={class:"form-group"},rt=d(()=>e("label",{for:"image-upload"},"Image Upload (Max:2MB)",-1)),ct={class:"section review-section"},dt=d(()=>e("h3",null,"Reviews",-1)),ut={key:0,class:"text-muted"},_t={key:1,class:"rating-summary-card"},vt={class:"overall-rating"},pt=d(()=>e("div",{class:"label"},"Overall",-1)),mt={class:"stars"},ht={class:"score"},gt={class:"sub-ratings"},ft=d(()=>e("strong",null,"Relax",-1)),yt=d(()=>e("strong",null,"Safety",-1)),bt=d(()=>e("strong",null,"Silence",-1)),wt={class:"review-form",id:"reviewForm"},kt=["onUpdate:modelValue"],xt=ne('<option value="5" data-v-600d05e4>⭐⭐⭐⭐⭐</option><option value="4" data-v-600d05e4>⭐⭐⭐⭐</option><option value="3" data-v-600d05e4>⭐⭐⭐</option><option value="2" data-v-600d05e4>⭐⭐</option><option value="1" data-v-600d05e4>⭐</option>',5),Ct=[xt],St={class:"form-group"},Et=d(()=>e("label",null,"Comment",-1)),Rt={key:0,class:"text-danger"},Tt={class:"review-header"},Ut={class:"d-flex align-items-center gap-3 mb-4"},Vt=["src"],$t={class:"review-scores"},Ft={class:"review-text"},Mt={class:"d-flex justify-content-between mt-5"},Dt={key:0},Pt={key:1},jt={__name:"PostDetail",props:{previous:Object,next:Object,categories:Array},setup(_){var O,A,B,H,W;const s=M(()=>z().props.post),x=z().props.auth.user,p=$(null),C=$(!1);function P(){i.title=s.value.title,i.category=s.value.category,i.location_name=s.value.location_name,i.latitude=s.value.latitude,i.longitude=s.value.longitude,i.description=s.value.description,i.visit_time=s.value.visit_time??[],C.value=!0}const i=q({title:"",category:"",location_name:"",latitude:"",longitude:"",description:"",visit_time:s.visit_time??[],status:"public",images:[]}),T=n=>{n.target.files.length?i.images=Array.from(n.target.files):i.images=[]};function U(){C.value=!1,i.reset()}function m(){i.post(route("posts.update",s.value.id),{forceFormData:!0,onSuccess:()=>{C.value=!1,location.reload()},onError:n=>{p.value.triggerToast(n,"error")}})}const j=M(()=>s.value.is_favorited),G=()=>{j.value?X.delete(route("favorite.destroy",s.value.id)):X.post(route("favorite.store",s.value.id))},N=M(()=>s.value.my_review!==null),I=$(!1),L=()=>{I.value=!I.value},v=q({post_id:s.value.id,rating_overall:((O=s.value.my_review)==null?void 0:O.rating_overall)||5,rating_silence:((A=s.value.my_review)==null?void 0:A.rating_silence)||5,rating_safety:((B=s.value.my_review)==null?void 0:B.rating_safety)||5,rating_relax:((H=s.value.my_review)==null?void 0:H.rating_relax)||5,comment:((W=s.value.my_review)==null?void 0:W.comment)||""}),J=()=>{N.value?v.put(route("reviews.update",s.value.my_review.id),{onSuccess:()=>{L(),p.value.triggerToast("Review updated successfully")},onError:n=>{p.value.triggerToast(n,"error")}}):v.post(route("reviews.store"),{onSuccess:()=>{L(),v.reset(),p.value.triggerToast("Review stored successfully")},onError:n=>{p.value.triggerToast(n,"error")}})},S=M(()=>{const n=s.value.reviews;if(!n.length)return null;const o=V=>n.reduce((F,t)=>F+t[V],0)/n.length;return{overall:o("rating_overall"),relax:o("rating_relax"),safety:o("rating_safety"),silence:o("rating_silence")}}),f=n=>{const o=Math.floor(n),V=n%1>=.5?1:0;return"⭐".repeat(o)+(V?"☆":"")},K=n=>new Date(n).toLocaleDateString();return(n,o)=>{var F;const V=te("Head");return r(),c(w,null,[u(V,null,{default:b(()=>{var t;return[e("title",null,l(s.value.title)+" | Chill-log",1),e("meta",{name:"description",content:s.value.description.slice(0,100)},null,8,he),e("meta",{property:"og:title",content:s.value.title},null,8,ge),e("meta",{property:"og:description",content:s.value.description.slice(0,100)},null,8,fe),e("meta",{property:"og:image",content:`/storage/${(t=s.value.images[0])==null?void 0:t.image_path}`},null,8,ye),be,e("meta",{property:"og:url",content:`https://chill-log.com/posts/${s.value.id}`},null,8,we)]}),_:1}),u(de,{ref_key:"toast",ref:p},null,512),u(re),e("div",ke,[e("div",xe,[e("div",Ce,[e("div",Se,[e("h2",null,l(s.value.title),1),e("div",Ee,l(s.value.category),1)]),e("div",Re,[(r(!0),c(w,null,E(s.value.images,t=>(r(),c("div",{key:t.id,class:"mb-3"},[e("img",{src:`/storage/${t.image_path}`,alt:"Post Image",class:"post-image img-fluid w-100 rounded",onError:o[0]||(o[0]=h=>h.target.src="/images/default.jpg")},null,40,Te)]))),128))]),e("div",Ue,[u(a(R),{href:n.route("users.show",s.value.user.id)},{default:b(()=>[e("img",{src:s.value.user.profile_image?`/storage/${s.value.user.profile_image}`:"/images/default.jpg",onError:o[1]||(o[1]=t=>t.target.src="/images/default.jpg"),alt:"Profile image",class:"rounded-circle",style:{width:"60px",height:"60px","object-fit":"cover"}},null,40,Ve)]),_:1},8,["href"]),e("div",null,[u(a(R),{href:n.route("users.show",s.value.user.id),class:"fw-bold text-decoration-none text-dark"},{default:b(()=>[g(l(s.value.user.name),1)]),_:1},8,["href"])])]),e("div",$e,[e("p",null,[Fe,g(" "+l(s.value.location_name),1)]),(F=s.value.visit_time)!=null&&F.length?(r(),c("p",Me,[De,(r(!0),c(w,null,E(s.value.visit_time,(t,h)=>(r(),c("span",{key:h,class:"badge bg-secondary me-2"},l(t),1))),128))])):k("",!0),e("p",null,[Pe,g(" "+l(s.value.description),1)])]),e("div",je,[e("button",{class:"btn",onClick:G},l(j.value?"★":"☆"),1),u(me)]),a(x)&&a(x).id===s.value.user_id?(r(),c("div",Ie,[e("button",{class:"btn",onClick:o[2]||(o[2]=t=>P())}," Edit ")])):(r(),c("div",Le,[e("button",{class:"btn",onClick:L},l(N.value?"Edit Review":"Leave a Review"),1)]))]),C.value?(r(),c("div",Ne,[e("div",Oe,[e("div",Ae,[e("div",Be,[e("div",{class:"modal-header"},[He,e("button",{type:"button",class:"btn-close",onClick:U})]),e("div",We,[e("div",ze,[e("div",qe,[Qe,y(e("input",{type:"text",id:"title","onUpdate:modelValue":o[3]||(o[3]=t=>a(i).title=t),placeholder:"e.g., Quiet Park"},null,512),[[D,a(i).title]])]),e("div",Xe,[Ye,y(e("select",{id:"category","onUpdate:modelValue":o[4]||(o[4]=t=>a(i).category=t)},[(r(!0),c(w,null,E(_.categories,t=>(r(),c("option",{key:t,value:t},l(t),9,Ge))),128))],512),[[Q,a(i).category]])]),e("div",Je,[Ke,e("div",Ze,[y(e("input",{type:"text",id:"location_name","onUpdate:modelValue":o[5]||(o[5]=t=>a(i).location_name=t),placeholder:"e.g., Shibuya, Tokyo"},null,512),[[D,a(i).location_name]])])]),e("div",et,[tt,e("div",st,[(r(),c(w,null,E(["morning","afternoon","evening","night","anytime"],t=>e("div",{key:t,class:"form-check-inline"},[y(e("input",{class:"btn-check",type:"checkbox",value:t,"onUpdate:modelValue":o[6]||(o[6]=h=>a(i).visit_time=h),id:`time-${t}`,autocomplete:"off"},null,8,ot),[[oe,a(i).visit_time]]),e("label",{class:ae(["btn btn-outline-secondary",{active:a(i).visit_time.includes(t)}]),for:`time-${t}`},l(t),11,at)])),64))])]),e("div",lt,[it,y(e("textarea",{id:"description","onUpdate:modelValue":o[7]||(o[7]=t=>a(i).description=t),placeholder:"Describe the charm of this spot"},null,512),[[D,a(i).description]])]),e("div",nt,[rt,e("input",{type:"file",id:"image-upload",onChange:T},null,32)]),e("div",{class:"buttons mt-4"},[e("button",{type:"button",class:"btn cancel-btn",onClick:U},"Cancel"),e("button",{class:"btn",onClick:m},"Save Changes")])])])])])])])):k("",!0),e("div",ct,[dt,s.value.reviews.length?S.value?(r(),c("div",_t,[e("div",vt,[pt,e("div",mt,l(f(S.value.overall)),1),e("div",ht,l(S.value.overall.toFixed(1)),1)]),e("ul",gt,[e("li",null,[ft,g(": "+l(f(S.value.relax)),1)]),e("li",null,[yt,g(": "+l(f(S.value.safety)),1)]),e("li",null,[bt,g(": "+l(f(S.value.silence)),1)])])])):k("",!0):(r(),c("p",ut,"No reviews yet.")),y(e("div",wt,[(r(),c(w,null,E(["rating_relax","rating_safety","rating_silence"],t=>e("div",{class:"form-group",key:t},[e("label",null,l(t.replace("rating_","").charAt(0).toUpperCase()+t.replace("rating_","").slice(1)),1),y(e("select",{"onUpdate:modelValue":h=>a(v)[t]=h},Ct,8,kt),[[Q,a(v)[t]]])])),64)),e("div",St,[Et,y(e("textarea",{"onUpdate:modelValue":o[8]||(o[8]=t=>a(v).comment=t),rows:"4",placeholder:"Write your review...(max 500 characters)"},null,512),[[D,a(v).comment]])]),e("p",null,l(a(v).comment.length)+" / 500 characters",1),e("button",{class:"btn",onClick:J},"Submit"),a(v).errors.comment?(r(),c("p",Rt,l(a(v).errors.comment),1)):k("",!0)],512),[[se,I.value]]),(r(!0),c(w,null,E(s.value.reviews,t=>(r(),c("div",{class:"review-box",key:t.id},[e("div",Tt,[e("div",Ut,[u(a(R),{href:n.route("users.show",t.user.id)},{default:b(()=>[e("img",{src:t.user.profile_image?`/storage/${t.user.profile_image}`:"/images/default.jpg",onError:o[9]||(o[9]=h=>h.target.src="/images/default.jpg"),alt:"Profile image",class:"rounded-circle",style:{width:"60px",height:"60px","object-fit":"cover"}},null,40,Vt)]),_:2},1032,["href"]),e("div",null,[u(a(R),{href:n.route("users.show",t.user.id),class:"fw-bold text-decoration-none text-dark"},{default:b(()=>[g(l(t.user.name),1)]),_:2},1032,["href"])])]),e("p",null,l(K(t.created_at)),1)]),e("ul",$t,[e("li",null,"Overall: "+l(f(t.rating_overall)),1),e("li",null,"Relax: "+l(f(t.rating_relax)),1),e("li",null,"Safety: "+l(f(t.rating_safety)),1),e("li",null,"Silence: "+l(f(t.rating_silence)),1)]),e("p",Ft,l(t.comment),1)]))),128))]),e("div",Mt,[_.previous?(r(),c("div",Dt,[u(a(R),{href:n.route("posts.show",_.previous.id),class:"btn btn-outline-secondary"},{default:b(()=>[g(" ← Previous ")]),_:1},8,["href"])])):k("",!0),_.next?(r(),c("div",Pt,[u(a(R),{href:n.route("posts.show",_.next.id),class:"btn btn-outline-secondary ms-auto"},{default:b(()=>[g(" Next → ")]),_:1},8,["href"])])):k("",!0)])])]),u(ce)],64)}}},Bt=Y(jt,[["__scopeId","data-v-600d05e4"]]);export{Bt as default};
