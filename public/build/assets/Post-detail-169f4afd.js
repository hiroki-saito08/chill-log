import{m as h,o as s,f as l,a as m,u as o,b as t,t as c,F as x,l as I,d as v,g as _,n as E,w as b,k as f,i as p,p as y,q as V,v as rt,e as D,s as C}from"./app-650406dd.js";import{_ as ct}from"./Header-6b0d4fbc.js";import{T as Y,Z as ut,i as mt}from"./index.esm-924e677d.js";import{_ as G}from"./PrimaryButton-8af1ef9a.js";import{_ as z,a as q}from"./SecondaryButton-9bbbdff7.js";import{E as Z}from"./index-082bcbc4.js";/* empty css            */import"./ApplicationLogo-7d66c00e.js";import"./NavLink-76d2f41f.js";const _t={class:"mt-10 p-2 md:w-9/12 m-auto"},pt={class:"md:p-10 md:border mb-5"},gt={class:"text-center text-xl font-bold"},ht={class:"text-right text-lg pt-5 pb-5"},ft={key:0},bt={style:{height:"70vh"}},vt=["src"],xt={key:1},yt={class:"mt-5 mb-5"},kt={class:"pt-5 pb-5 whitespace-pre-wrap text-center"},wt={class:"flex justify-between pt-2 border-t"},It={key:0},Ct={key:1},Pt={class:"flex flex-wrap justify-end"},Et={key:0},Vt={class:"m-5"},Rt={class:"mt-4 mb-4"},Ut=t("p",null,[t("strong",null,"座標:")],-1),Mt={class:"flex"},St={class:"mt-10 md:w-2/3 m-auto"},Tt=t("h3",{class:"mt-5 mb-10 text-xl font-bold"},"コメント一覧",-1),jt={key:0},zt={class:"border p-5"},Ft={class:"stars relative mb-4"},At=["checked"],Lt=t("label",null,"★",-1),Nt=["checked"],Kt=t("label",null,"★",-1),$t=["checked"],Bt=t("label",null,"★",-1),Ht=["checked"],Ot=t("label",null,"★",-1),Dt=["checked"],Yt=t("label",null,"★",-1),Gt={key:0},qt={class:"h-80 mb-5"},Zt=["src"],Xt={class:"pt-2 pb-4 text-xl font-bold"},Jt={class:"pt-2 pb-2"},Qt={class:"text-right text-lg pt-5 pb-5"},Wt={key:1,class:"flex flex-wrap justify-end"},te={class:"m-10 flex justify-center"},ee={class:"container mx-auto flex"},oe={class:"bg-white rounded-lg p-8 flex flex-col md:ml-auto w-full mt-10 md:mt-0 relative z-10 shadow-md"},se=t("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"記事を編集する",-1),le={key:0},ne={class:"m-3"},ae={class:"relative mb-4"},ie=t("label",{for:"title",value:"title",class:"leading-7 text-sm text-gray-600"},"Title",-1),de={class:"relative mb-4"},re=t("label",{for:"content",value:"content",class:"leading-7 text-sm text-gray-600"},"content",-1),ce={class:"flex mb-5"},ue=["disabled"],me=t("label",{for:" deleteImage",class:"leading-7 pr-3"},"登録済みの画像を削除",-1),_e=["disabled"],pe={key:1,class:"mt-2 mb-2"},ge={class:"mt-6 flex justify-end"},he={key:0},fe={key:1},be={class:"m-5"},ve={key:0,class:"mt-4 mb-4"},xe=t("p",null,[t("strong",null,"クリックした位置情報:")],-1),ye={class:"container mx-auto flex"},ke={class:"bg-white rounded-lg p-8 flex flex-col md:ml-auto w-full mt-10 md:mt-0 relative z-10 shadow-md"},we=t("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"コメントを投稿する",-1),Ie={key:0},Ce={class:"m-3"},Pe={class:"stars relative mb-4"},Ee={class:"form-stars"},Ve=t("label",{for:"star01"},"★",-1),Re=t("label",{for:"star02"},"★",-1),Ue=t("label",{for:"star03"},"★",-1),Me=t("label",{for:"star04"},"★",-1),Se=t("label",{for:"star05"},"★",-1),Te={class:"relative mb-4"},je=t("label",{for:"comment_title",value:"comment_title",class:"leading-7 text-sm text-gray-600"},"Title",-1),ze={class:"relative mb-4"},Fe=t("label",{for:"comment_content",value:"comment_content",class:"leading-7 text-sm text-gray-600"},"Content",-1),Ae={class:"mt-6 flex justify-end"},Ge={__name:"Post-detail",props:{post:Object,user:Array,userId:Number,errors:Object,ownReview:Object,ownPost:Boolean,isFavorite:Boolean,favoriteId:Number},setup(r){const d=r,{VITE_GMAP_API_KEY:F}={VITE_PUSHER_APP_KEY:"",VITE_PUSHER_HOST:"",VITE_PUSHER_PORT:"443",VITE_PUSHER_SCHEME:"https",VITE_PUSHER_APP_CLUSTER:"mt1",VITE_GMAP_API_KEY:"AIzaSyBMN5q_xRCUrlFZf2jdYvlft75XVP1hYEw",BASE_URL:"/build/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},k=h(null),A=d.post.location.split(","),R=Number(A[0]),U=Number(A[1]),M=h({lat:R,lng:U}),L=h(16),g=h([]),N=h(!1),S=h(!1),T=h(!1);h(!1);const j=h(!1),a=Y({post_id:d.post.id,user_id:d.userId,star:null,comment_title:null,comment_content:null,image:null}),i=Y({user_id:d.userId,status:d.post.status,title:d.post.title,content:d.post.content,image:d.post.image,deleteImage:!1,location:{lat:R,lng:U}}),K=()=>{d.user===null?f.Inertia.get(route("login")):(d.ownReview!=null&&(a.star=d.ownReview.star,a.comment_title=d.ownReview.comment_title,a.comment_content=d.ownReview.comment_content,N.value=!0),nt())},X=u=>{k.value={lat:u.latLng.lat(),lng:u.latLng.lng()}},J=()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(u=>{M.value={lat:u.coords.latitude,lng:u.coords.longitude}}):alert("Geolocation is not supported by this browser.")},Q=()=>{i.location=k.value,B()},W=()=>{d.user===null?f.Inertia.get(route("login")):d.isFavorite?f.Inertia.delete(route("favorite.destroy",d.favoriteId)):f.Inertia.post(route("favorite.store",{post_id:d.post.id,user_id:d.userId}))},tt=()=>{confirm("コメントを削除してよろしいですか？")&&(f.Inertia.delete(route("review.destroy",d.ownReview.id)),alert("コメントを削除しました")),w()},et=()=>{N.value?H()&&(f.Inertia.post(route("review.update",d.ownReview.id),{_method:"put",form:a}),alert("コメントを更新しました"),P()):H()&&(f.Inertia.post(route("review.store"),a),alert("コメントを投稿しました"),P())},ot=()=>{dt()&&(i.status=1,f.Inertia.post(route("post.update",d.post.id),{_method:"put",form:i}),alert("投稿を更新しました"),w())},st=()=>{confirm("投稿を削除してよろしいですか？")&&(f.Inertia.delete(route("post.destroy",d.post.id)),alert("投稿を削除しました")),w()},lt=u=>{const n=u.target.files[0];a.image=n},$=u=>{const n=u.target.files[0];i.image=n},nt=()=>{S.value=!0},P=()=>{S.value=!1,a.reset()},at=()=>{j.value=!0},B=()=>{j.value=!1},it=()=>{T.value=!0},w=()=>{T.value=!1,i.reset()},dt=()=>(g.value=[],i.title&&i.content&&i.location.lat?!0:(i.title||g.value.push("Titleは必須です"),i.content||g.value.push("Contentは必須です"),i.location.lat||g.value.push("位置の選択は必須です"),!1)),H=()=>(g.value=[],a.comment_title&&a.comment_content?!0:(a.comment_title||g.value.push("Titleは必須です"),a.comment_content||g.value.push("Contentは必須です"),!1));return(u,n)=>(s(),l(x,null,[m(o(ut),{title:"Post-detail"}),m(ct,{authProps:d,page:"post-detail"},null,8,["authProps"]),t("div",_t,[t("article",pt,[t("h2",gt,"「"+c(r.post.title)+"」",1),t("h3",ht,c(r.post.user.name)+" さんの投稿",1),r.post.images.length?(s(),l("div",ft,[(s(!0),l(x,null,I(r.post.images,e=>(s(),l("div",{key:e.id},[t("div",bt,[t("img",{src:e.path,alt:"画像",class:"w-full h-full object-cover"},null,8,vt)])]))),128))])):(s(),l("div",xt," 画像なし ")),t("div",yt,[t("p",kt,c(r.post.content),1)]),t("div",wt,[t("div",null,"コメント: "+c(r.post.reviews_count)+"件",1),t("div",null,[v(" 評価: "),r.post.rating[0]?(s(),l("span",It,c(r.post.rating[0].avg_review),1)):(s(),l("span",Ct," 0.00 "))])]),t("div",Pt,[r.ownPost?(s(),l("button",{key:0,onClick:it,class:"text-white bg-indigo-500 border-0 py-2 px-6 focus:outline-none hover:bg-indigo-600 rounded text-lg m-5 block"},"編集")):_("",!0),r.ownPost?(s(),l("button",{key:1,onClick:st,class:"text-white bg-red-500 border-0 py-2 px-6 focus:outline-none hover:bg-indigo-600 rounded text-lg m-5 block"},"削除")):_("",!0)])]),r.post.location?(s(),l("div",Et,[m(o(Z),{"api-key":o(F),style:{width:"100%",height:"450px"},center:M.value,zoom:L.value},null,8,["api-key","center","zoom"]),t("div",Vt,[t("div",Rt,[Ut,t("p",null,"緯度: "+c(o(R)),1),t("p",null,"経度: "+c(o(U)),1)])])])):_("",!0),t("div",Mt,[r.ownPost?_("",!0):(s(),l("button",{key:0,onClick:K,class:"text-white bg-indigo-500 border-0 py-2 px-6 focus:outline-none hover:bg-indigo-600 rounded text-lg ml-auto block"},"コメントする")),r.ownPost?_("",!0):(s(),l("button",{key:1,onClick:W},[t("a",{class:E(["unfavorite-star",{"favorite-star":d.isFavorite}])},"★",2)]))])]),t("div",St,[Tt,t("article",null,[r.post.reviews?(s(),l("div",jt,[(s(!0),l(x,null,I(r.post.reviews,e=>(s(),l("div",{key:e.id},[t("article",zt,[t("div",Ft,[t("span",null,[t("input",{class:"star5",type:"radio",checked:e.star==5},null,8,At),Lt,t("input",{class:"star4",type:"radio",checked:e.star==4},null,8,Nt),Kt,t("input",{class:"star3",type:"radio",checked:e.star==3},null,8,$t),Bt,t("input",{class:"star2",type:"radio",checked:e.star==2},null,8,Ht),Ot,t("input",{class:"star1",type:"radio",checked:e.star==1},null,8,Dt),Yt])]),e.images?(s(),l("div",Gt,[(s(!0),l(x,null,I(e.images,O=>(s(),l("div",{key:O.id},[t("div",qt,[t("img",{src:O.path,alt:"画像",class:"w-full h-full object-cover"},null,8,Zt)])]))),128))])):_("",!0),t("p",Xt,c(e.comment_title),1),t("p",Jt,c(e.comment_content),1),t("h3",Qt,c(e.user.name)+" さんの投稿",1),e.user_id==d.userId?(s(),l("div",Wt,[t("button",{onClick:K,class:"text-white bg-indigo-500 border-0 py-2 px-6 focus:outline-none hover:bg-indigo-600 rounded text-lg m-5 block"},"編集"),t("button",{onClick:tt,class:"text-white bg-red-500 border-0 py-2 px-6 focus:outline-none hover:bg-indigo-600 rounded text-lg m-5 block"},"削除")])):_("",!0)])]))),128))])):_("",!0)])]),t("div",te,[m(o(mt),{class:"text-white bg-indigo-500 border-0 py-2 px-6 focus:outline-none hover:bg-indigo-600 rounded text-lg",href:u.route("posts")},{default:b(()=>[v("投稿一覧へ")]),_:1},8,["href"])]),m(z,{show:T.value,onClose:w},{default:b(()=>[t("form",{onSubmit:D(ot,["prevent"])},[t("div",ee,[t("div",oe,[se,g.value.length?(s(),l("p",le,[t("ul",ne,[(s(!0),l(x,null,I(g.value,e=>(s(),l("li",{key:e,class:"text-red-500 list-disc mb-3"},c(e),1))),128))])])):_("",!0),t("div",ae,[ie,p(t("input",{id:"title","onUpdate:modelValue":n[0]||(n[0]=e=>o(i).title=e),type:"text",placeholder:"title",onKeyup:V(e=>!1,["enter"]),name:"title",maxlength:"20",class:"w-full bg-white rounded border border-gray-300 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 text-base outline-none text-gray-700 py-1 px-3 leading-8 transition-colors duration-200 ease-in-out"},null,544),[[y,o(i).title]])]),t("div",de,[re,p(t("textarea",{id:"content","onUpdate:modelValue":n[1]||(n[1]=e=>o(i).content=e),type:"textarea",placeholder:"content",onKeyup:V(e=>!1,["enter"]),name:"content",maxlength:"250",class:"w-full bg-white rounded border border-gray-300 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 h-32 text-base outline-none text-gray-700 py-1 px-3 resize-none leading-6 transition-colors duration-200 ease-in-out"},null,544),[[y,o(i).content]])]),t("div",ce,[t("div",null,[t("input",{id:"image",onChange:$,type:"file",placeholder:"image",name:"image",disabled:o(i).deleteImage},null,40,ue)]),t("div",null,[me,p(t("input",{id:"deleteImage","onUpdate:modelValue":n[2]||(n[2]=e=>o(i).deleteImage=e),onChange:$,type:"checkbox",name:"deleteImage",disabled:o(i).image,class:E({"opacity-25":o(i).image})},null,42,_e),[[rt,o(i).deleteImage]])])]),t("button",{onClick:at,class:"text-white bg-indigo-500 border-0 py-2 px-6 text-lg w-2/5",type:"button"},"位置を選択する"),o(i).location.lat?(s(),l("div",pe,[t("p",null,[v("緯度: "),p(t("input",{id:"location","onUpdate:modelValue":n[3]||(n[3]=e=>o(i).location.lat=e),type:"text",name:"location.lat",class:"border-none"},null,512),[[y,o(i).location.lat]])]),t("p",null,[v("経度: "),p(t("input",{id:"location","onUpdate:modelValue":n[4]||(n[4]=e=>o(i).location.lng=e),type:"text",name:"location.lng",class:"border-none"},null,512),[[y,o(i).location.lng]])])])):_("",!0),t("div",ge,[m(q,{onClick:w},{default:b(()=>[v(" Cancel ")]),_:1}),m(G,{class:E(["ml-3",{"opacity-25":o(i).processing}]),disabled:o(i).processing},{default:b(()=>[d.post.status?(s(),l("span",he,"更新する")):(s(),l("span",fe,"投稿する"))]),_:1},8,["class","disabled"])])])])],32)]),_:1},8,["show"]),m(z,{show:j.value,onClose:B},{default:b(()=>[m(o(Z),{ref:"mapRef","api-key":o(F),style:{width:"100%",height:"450px"},center:M.value,zoom:L.value,onClick:X},null,8,["api-key","center","zoom"]),t("div",be,[t("button",{class:"block mb-5 border-b border-black",onClick:J},"現在地を取得する"),k.value?(s(),l("div",ve,[xe,t("p",null,"緯度: "+c(k.value.lat),1),t("p",null,"経度: "+c(k.value.lng),1)])):_("",!0),t("button",{onClick:Q,class:"text-white bg-indigo-500 border-0 py-2 px-6 focus:outline-none hover:bg-indigo-600 rounded text-lg"},"ここを選択する")])]),_:1},8,["show"]),m(z,{show:S.value,onClose:P},{default:b(()=>[t("form",{onSubmit:D(et,["prevent"])},[t("div",ye,[t("div",ke,[we,g.value.length?(s(),l("p",Ie,[t("ul",Ce,[(s(!0),l(x,null,I(g.value,e=>(s(),l("li",{key:e,class:"text-red-500 list-disc mb-3"},c(e),1))),128))])])):_("",!0),t("div",Pe,[t("span",Ee,[p(t("input",{id:"star01",type:"radio",name:"star",value:"5","onUpdate:modelValue":n[5]||(n[5]=e=>o(a).star=e)},null,512),[[C,o(a).star]]),Ve,p(t("input",{id:"star02",type:"radio",name:"star",value:"4","onUpdate:modelValue":n[6]||(n[6]=e=>o(a).star=e)},null,512),[[C,o(a).star]]),Re,p(t("input",{id:"star03",type:"radio",name:"star",value:"3","onUpdate:modelValue":n[7]||(n[7]=e=>o(a).star=e)},null,512),[[C,o(a).star]]),Ue,p(t("input",{id:"star04",type:"radio",name:"star",value:"2","onUpdate:modelValue":n[8]||(n[8]=e=>o(a).star=e)},null,512),[[C,o(a).star]]),Me,p(t("input",{id:"star05",type:"radio",name:"star",value:"1","onUpdate:modelValue":n[9]||(n[9]=e=>o(a).star=e)},null,512),[[C,o(a).star]]),Se])]),t("div",Te,[je,p(t("input",{id:"comment_title","onUpdate:modelValue":n[10]||(n[10]=e=>o(a).comment_title=e),type:"text",placeholder:"title",onKeyup:V(e=>!1,["enter"]),name:"comment_title",maxlength:"20",class:"w-full bg-white rounded border border-gray-300 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 text-base outline-none text-gray-700 py-1 px-3 leading-8 transition-colors duration-200 ease-in-out"},null,544),[[y,o(a).comment_title]])]),t("div",ze,[Fe,p(t("textarea",{id:"comment_content","onUpdate:modelValue":n[11]||(n[11]=e=>o(a).comment_content=e),type:"textarea",placeholder:"content",onKeyup:V(e=>!1,["enter"]),name:"comment_content",maxlength:"250",class:"w-full bg-white rounded border border-gray-300 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 h-32 text-base outline-none text-gray-700 py-1 px-3 resize-none leading-6 transition-colors duration-200 ease-in-out"},null,544),[[y,o(a).comment_content]])]),t("input",{id:"image",onChange:lt,type:"file",placeholder:"image",name:"image"},null,32),t("div",Ae,[m(q,{onClick:P},{default:b(()=>[v(" Cancel ")]),_:1}),m(G,{class:E(["ml-3",{"opacity-25":o(a).processing}]),disabled:o(a).processing},{default:b(()=>[v(" 投稿する ")]),_:1},8,["class","disabled"])])])])],32)]),_:1},8,["show"])],64))}};export{Ge as default};
