import{m as h,o as s,f as l,a as m,u as o,b as t,t as c,F as x,l as I,d as v,g as _,n as V,w as b,k as f,i as p,p as y,q as U,v as ct,e as Y,s as P}from"./app-c12fad1a.js";import{_ as ut}from"./Header-f8bf9dd7.js";import{T as G,Z as mt,i as _t}from"./index.esm-28f94561.js";import{_ as q}from"./PrimaryButton-f7a1acc3.js";import{_ as F,a as Z}from"./SecondaryButton-954ca16e.js";import{E as X}from"./index-1fbe73b1.js";/* empty css            */import"./ApplicationLogo-d8cb323c.js";import"./NavLink-05d9f05b.js";const pt={class:"mt-10 w-9/12 m-auto"},gt={class:"p-10 border mb-5"},ht={class:"text-center text-xl font-bold"},ft={class:"text-right text-lg pt-5 pb-5"},bt={key:0},vt={class:"h-svh"},xt=["src"],yt={key:1},kt={class:"mt-5 mb-5"},wt={class:"pt-5 pb-5 whitespace-pre-wrap text-center"},Ct={class:"flex justify-between pt-2 border-t"},It={key:0},Pt={key:1},Et={class:"flex flex-wrap justify-end"},Vt={key:0},Ut={class:"m-5"},Mt={class:"mt-4 mb-4"},St=t("p",null,[t("strong",null,"座標:")],-1),Tt={class:"flex"},Rt={class:"mt-10 w-2/3 m-auto"},jt=t("h3",{class:"mt-5 mb-10 text-xl font-bold"},"コメント一覧",-1),zt={key:0},Ft={class:"border p-5"},At={class:"stars relative mb-4"},Lt=["checked"],Kt=t("label",null,"★",-1),Nt=["checked"],$t=t("label",null,"★",-1),Bt=["checked"],Ht=t("label",null,"★",-1),Ot=["checked"],Dt=t("label",null,"★",-1),Yt=["checked"],Gt=t("label",null,"★",-1),qt={key:0},Zt={class:"h-80 mb-5"},Xt=["src"],Jt={class:"pt-2 pb-4 text-xl font-bold"},Qt={class:"pt-2 pb-2"},Wt={class:"text-right text-lg pt-5 pb-5"},te={key:1,class:"flex flex-wrap justify-end"},ee={class:"m-10 flex justify-center"},oe={class:"container mx-auto flex"},se={class:"bg-white rounded-lg p-8 flex flex-col md:ml-auto w-full mt-10 md:mt-0 relative z-10 shadow-md"},le=t("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"記事を編集する",-1),ne={key:0},ae={class:"m-3"},ie={class:"relative mb-4"},de=t("label",{for:"title",value:"title",class:"leading-7 text-sm text-gray-600"},"Title",-1),re={class:"relative mb-4"},ce=t("label",{for:"content",value:"content",class:"leading-7 text-sm text-gray-600"},"content",-1),ue={class:"flex mb-5"},me=["disabled"],_e=t("label",{for:" deleteImage",class:"leading-7 pr-3"},"登録済みの画像を削除",-1),pe=["disabled"],ge={key:1,class:"mt-2 mb-2"},he={class:"mt-6 flex justify-end"},fe={key:0},be={key:1},ve={class:"m-5"},xe={key:0,class:"mt-4 mb-4"},ye=t("p",null,[t("strong",null,"クリックした位置情報:")],-1),ke={class:"container mx-auto flex"},we={class:"bg-white rounded-lg p-8 flex flex-col md:ml-auto w-full mt-10 md:mt-0 relative z-10 shadow-md"},Ce=t("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"コメントを投稿する",-1),Ie={key:0},Pe={class:"m-3"},Ee={class:"stars relative mb-4"},Ve={class:"form-stars"},Ue=t("label",{for:"star01"},"★",-1),Me=t("label",{for:"star02"},"★",-1),Se=t("label",{for:"star03"},"★",-1),Te=t("label",{for:"star04"},"★",-1),Re=t("label",{for:"star05"},"★",-1),je={class:"relative mb-4"},ze=t("label",{for:"comment_title",value:"comment_title",class:"leading-7 text-sm text-gray-600"},"Title",-1),Fe={class:"relative mb-4"},Ae=t("label",{for:"comment_content",value:"comment_content",class:"leading-7 text-sm text-gray-600"},"Content",-1),Le={class:"mt-6 flex justify-end"},qe={__name:"Post-detail",props:{post:Object,user:Array,errors:Object,review:Object,own_post:Boolean,isFavorite:Boolean,favoriteId:Number},setup(r){const d=r,{VITE_GMAP_API_KEY:A}={VITE_PUSHER_APP_KEY:"",VITE_PUSHER_HOST:"",VITE_PUSHER_PORT:"443",VITE_PUSHER_SCHEME:"https",VITE_PUSHER_APP_CLUSTER:"mt1",VITE_GMAP_API_KEY:"AIzaSyBMN5q_xRCUrlFZf2jdYvlft75XVP1hYEw",BASE_URL:"/build/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},k=h(null),L=d.post.location.split(","),M=Number(L[0]),S=Number(L[1]),T=h({lat:M,lng:S}),K=h(16),g=h([]),N=h(!1),R=h(!1),j=h(!1),w=h(!1),z=h(!1);d.user!==null&&(w.value=d.user.id);const a=G({post_id:d.post.id,user_id:w.value,star:null,comment_title:null,comment_content:null,image:null}),i=G({user_id:w.value,status:d.post.status,title:d.post.title,content:d.post.content,image:d.post.image,deleteImage:!1,location:{lat:M,lng:S}}),$=()=>{d.user===null?f.Inertia.get(route("login")):(d.review!=null&&(a.star=d.review.star,a.comment_title=d.review.comment_title,a.comment_content=d.review.comment_content,N.value=!0),at())},J=u=>{k.value={lat:u.latLng.lat(),lng:u.latLng.lng()}},Q=()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(u=>{T.value={lat:u.coords.latitude,lng:u.coords.longitude}}):alert("Geolocation is not supported by this browser.")},W=()=>{i.location=k.value,H()},tt=()=>{d.user===null?f.Inertia.get(route("login")):d.isFavorite?f.Inertia.delete(route("favorite.destroy",d.favoriteId)):f.Inertia.post(route("favorite.store",{post_id:d.post.id,user_id:w.value}))},et=()=>{confirm("コメントを削除してよろしいですか？")&&(f.Inertia.delete(route("review.destroy",d.review.id)),alert("コメントを削除しました")),C()},ot=()=>{N.value?O()&&(f.Inertia.post(route("review.update",d.review.id),{_method:"put",form:a}),alert("コメントを更新しました"),E()):O()&&(f.Inertia.post(route("review.store"),a),alert("コメントを投稿しました"),E())},st=()=>{rt()&&(i.status=1,f.Inertia.post(route("post.update",d.post.id),{_method:"put",form:i}),alert("投稿を更新しました"),C())},lt=()=>{confirm("投稿を削除してよろしいですか？")&&(f.Inertia.delete(route("post.destroy",d.post.id)),alert("投稿を削除しました")),C()},nt=u=>{const n=u.target.files[0];a.image=n},B=u=>{const n=u.target.files[0];i.image=n},at=()=>{R.value=!0},E=()=>{R.value=!1,a.reset()},it=()=>{z.value=!0},H=()=>{z.value=!1},dt=()=>{j.value=!0},C=()=>{j.value=!1,i.reset()},rt=()=>(g.value=[],i.title&&i.content&&i.location.lat?!0:(i.title||g.value.push("Titleは必須です"),i.content||g.value.push("Contentは必須です"),i.location.lat||g.value.push("位置の選択は必須です"),!1)),O=()=>(g.value=[],a.comment_title&&a.comment_content?!0:(a.comment_title||g.value.push("Titleは必須です"),a.comment_content||g.value.push("Contentは必須です"),!1));return(u,n)=>(s(),l(x,null,[m(o(mt),{title:"Post-detail"}),m(ut,{authProps:d},null,8,["authProps"]),t("div",pt,[t("article",gt,[t("h2",ht,"「"+c(r.post.title)+"」",1),t("h3",ft,c(r.post.user.name)+" さんの投稿",1),r.post.images.length?(s(),l("div",bt,[(s(!0),l(x,null,I(r.post.images,e=>(s(),l("div",{key:e.id},[t("div",vt,[t("img",{src:e.path,alt:"画像",class:"w-full h-full object-cover"},null,8,xt)])]))),128))])):(s(),l("div",yt," 画像なし ")),t("div",kt,[t("p",wt,c(r.post.content),1)]),t("div",Ct,[t("div",null,"コメント: "+c(r.post.reviews_count)+"件",1),t("div",null,[v(" 評価: "),r.post.rating[0]?(s(),l("span",It,c(r.post.rating[0].avg_review),1)):(s(),l("span",Pt," 0.00 "))])]),t("div",Et,[r.own_post?(s(),l("button",{key:0,onClick:dt,class:"text-white bg-indigo-500 border-0 py-2 px-6 focus:outline-none hover:bg-indigo-600 rounded text-lg m-5 block"},"編集")):_("",!0),r.own_post?(s(),l("button",{key:1,onClick:lt,class:"text-white bg-red-500 border-0 py-2 px-6 focus:outline-none hover:bg-indigo-600 rounded text-lg m-5 block"},"削除")):_("",!0)])]),r.post.location?(s(),l("div",Vt,[m(o(X),{"api-key":o(A),style:{width:"100%",height:"450px"},center:T.value,zoom:K.value},null,8,["api-key","center","zoom"]),t("div",Ut,[t("div",Mt,[St,t("p",null,"緯度: "+c(o(M)),1),t("p",null,"経度: "+c(o(S)),1)])])])):_("",!0),t("div",Tt,[r.own_post?_("",!0):(s(),l("button",{key:0,onClick:$,class:"text-white bg-indigo-500 border-0 py-2 px-6 focus:outline-none hover:bg-indigo-600 rounded text-lg ml-auto block"},"コメントする")),r.own_post?_("",!0):(s(),l("button",{key:1,onClick:tt},[t("a",{class:V(["unfavorite-star",{"favorite-star":d.isFavorite}])},"★",2)]))])]),t("div",Rt,[jt,t("article",null,[r.post.reviews?(s(),l("div",zt,[(s(!0),l(x,null,I(r.post.reviews,e=>(s(),l("div",{key:e.id},[t("article",Ft,[t("div",At,[t("span",null,[t("input",{class:"star5",type:"radio",checked:e.star==5},null,8,Lt),Kt,t("input",{class:"star4",type:"radio",checked:e.star==4},null,8,Nt),$t,t("input",{class:"star3",type:"radio",checked:e.star==3},null,8,Bt),Ht,t("input",{class:"star2",type:"radio",checked:e.star==2},null,8,Ot),Dt,t("input",{class:"star1",type:"radio",checked:e.star==1},null,8,Yt),Gt])]),e.images?(s(),l("div",qt,[(s(!0),l(x,null,I(e.images,D=>(s(),l("div",{key:D.id},[t("div",Zt,[t("img",{src:D.path,alt:"画像",class:"w-full h-full object-cover"},null,8,Xt)])]))),128))])):_("",!0),t("p",Jt,c(e.comment_title),1),t("p",Qt,c(e.comment_content),1),t("h3",Wt,c(e.user.name)+" さんの投稿",1),e.user_id==w.value.value?(s(),l("div",te,[t("button",{onClick:$,class:"text-white bg-indigo-500 border-0 py-2 px-6 focus:outline-none hover:bg-indigo-600 rounded text-lg m-5 block"},"編集"),t("button",{onClick:et,class:"text-white bg-red-500 border-0 py-2 px-6 focus:outline-none hover:bg-indigo-600 rounded text-lg m-5 block"},"削除")])):_("",!0)])]))),128))])):_("",!0)])]),t("div",ee,[m(o(_t),{class:"text-white bg-indigo-500 border-0 py-2 px-6 focus:outline-none hover:bg-indigo-600 rounded text-lg",href:u.route("posts")},{default:b(()=>[v("投稿一覧へ")]),_:1},8,["href"])]),m(F,{show:j.value,onClose:C},{default:b(()=>[t("form",{onSubmit:Y(st,["prevent"])},[t("div",oe,[t("div",se,[le,g.value.length?(s(),l("p",ne,[t("ul",ae,[(s(!0),l(x,null,I(g.value,e=>(s(),l("li",{key:e,class:"text-red-500 list-disc mb-3"},c(e),1))),128))])])):_("",!0),t("div",ie,[de,p(t("input",{id:"title","onUpdate:modelValue":n[0]||(n[0]=e=>o(i).title=e),type:"text",placeholder:"title",onKeyup:U(e=>!1,["enter"]),name:"title",maxlength:"20",class:"w-full bg-white rounded border border-gray-300 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 text-base outline-none text-gray-700 py-1 px-3 leading-8 transition-colors duration-200 ease-in-out"},null,544),[[y,o(i).title]])]),t("div",re,[ce,p(t("textarea",{id:"content","onUpdate:modelValue":n[1]||(n[1]=e=>o(i).content=e),type:"textarea",placeholder:"content",onKeyup:U(e=>!1,["enter"]),name:"content",maxlength:"250",class:"w-full bg-white rounded border border-gray-300 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 h-32 text-base outline-none text-gray-700 py-1 px-3 resize-none leading-6 transition-colors duration-200 ease-in-out"},null,544),[[y,o(i).content]])]),t("div",ue,[t("div",null,[t("input",{id:"image",onChange:B,type:"file",placeholder:"image",name:"image",disabled:o(i).deleteImage},null,40,me)]),t("div",null,[_e,p(t("input",{id:"deleteImage","onUpdate:modelValue":n[2]||(n[2]=e=>o(i).deleteImage=e),onChange:B,type:"checkbox",name:"deleteImage",disabled:o(i).image,class:V({"opacity-25":o(i).image})},null,42,pe),[[ct,o(i).deleteImage]])])]),t("button",{onClick:it,class:"text-white bg-indigo-500 border-0 py-2 px-6 text-lg w-2/5",type:"button"},"位置を選択する"),o(i).location.lat?(s(),l("div",ge,[t("p",null,[v("緯度: "),p(t("input",{id:"location","onUpdate:modelValue":n[3]||(n[3]=e=>o(i).location.lat=e),type:"text",name:"location.lat",class:"border-none"},null,512),[[y,o(i).location.lat]])]),t("p",null,[v("経度: "),p(t("input",{id:"location","onUpdate:modelValue":n[4]||(n[4]=e=>o(i).location.lng=e),type:"text",name:"location.lng",class:"border-none"},null,512),[[y,o(i).location.lng]])])])):_("",!0),t("div",he,[m(Z,{onClick:C},{default:b(()=>[v(" Cancel ")]),_:1}),m(q,{class:V(["ml-3",{"opacity-25":o(i).processing}]),disabled:o(i).processing},{default:b(()=>[d.post.status?(s(),l("span",fe,"更新する")):(s(),l("span",be,"投稿する"))]),_:1},8,["class","disabled"])])])])],32)]),_:1},8,["show"]),m(F,{show:z.value,onClose:H},{default:b(()=>[m(o(X),{ref:"mapRef","api-key":o(A),style:{width:"100%",height:"450px"},center:T.value,zoom:K.value,onClick:J},null,8,["api-key","center","zoom"]),t("div",ve,[t("button",{class:"block mb-5 border-b border-black",onClick:Q},"現在地を取得する"),k.value?(s(),l("div",xe,[ye,t("p",null,"緯度: "+c(k.value.lat),1),t("p",null,"経度: "+c(k.value.lng),1)])):_("",!0),t("button",{onClick:W,class:"text-white bg-indigo-500 border-0 py-2 px-6 focus:outline-none hover:bg-indigo-600 rounded text-lg"},"ここを選択する")])]),_:1},8,["show"]),m(F,{show:R.value,onClose:E},{default:b(()=>[t("form",{onSubmit:Y(ot,["prevent"])},[t("div",ke,[t("div",we,[Ce,g.value.length?(s(),l("p",Ie,[t("ul",Pe,[(s(!0),l(x,null,I(g.value,e=>(s(),l("li",{key:e,class:"text-red-500 list-disc mb-3"},c(e),1))),128))])])):_("",!0),t("div",Ee,[t("span",Ve,[p(t("input",{id:"star01",type:"radio",name:"star",value:"5","onUpdate:modelValue":n[5]||(n[5]=e=>o(a).star=e)},null,512),[[P,o(a).star]]),Ue,p(t("input",{id:"star02",type:"radio",name:"star",value:"4","onUpdate:modelValue":n[6]||(n[6]=e=>o(a).star=e)},null,512),[[P,o(a).star]]),Me,p(t("input",{id:"star03",type:"radio",name:"star",value:"3","onUpdate:modelValue":n[7]||(n[7]=e=>o(a).star=e)},null,512),[[P,o(a).star]]),Se,p(t("input",{id:"star04",type:"radio",name:"star",value:"2","onUpdate:modelValue":n[8]||(n[8]=e=>o(a).star=e)},null,512),[[P,o(a).star]]),Te,p(t("input",{id:"star05",type:"radio",name:"star",value:"1","onUpdate:modelValue":n[9]||(n[9]=e=>o(a).star=e)},null,512),[[P,o(a).star]]),Re])]),t("div",je,[ze,p(t("input",{id:"comment_title","onUpdate:modelValue":n[10]||(n[10]=e=>o(a).comment_title=e),type:"text",placeholder:"title",onKeyup:U(e=>!1,["enter"]),name:"comment_title",maxlength:"20",class:"w-full bg-white rounded border border-gray-300 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 text-base outline-none text-gray-700 py-1 px-3 leading-8 transition-colors duration-200 ease-in-out"},null,544),[[y,o(a).comment_title]])]),t("div",Fe,[Ae,p(t("textarea",{id:"comment_content","onUpdate:modelValue":n[11]||(n[11]=e=>o(a).comment_content=e),type:"textarea",placeholder:"content",onKeyup:U(e=>!1,["enter"]),name:"comment_content",maxlength:"250",class:"w-full bg-white rounded border border-gray-300 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 h-32 text-base outline-none text-gray-700 py-1 px-3 resize-none leading-6 transition-colors duration-200 ease-in-out"},null,544),[[y,o(a).comment_content]])]),t("input",{id:"image",onChange:nt,type:"file",placeholder:"image",name:"image"},null,32),t("div",Le,[m(Z,{onClick:E},{default:b(()=>[v(" Cancel ")]),_:1}),m(q,{class:V(["ml-3",{"opacity-25":o(a).processing}]),disabled:o(a).processing},{default:b(()=>[v(" 投稿する ")]),_:1},8,["class","disabled"])])])])],32)]),_:1},8,["show"])],64))}};export{qe as default};
