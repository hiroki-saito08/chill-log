import{m as h,o as n,f as a,a as p,u as o,b as t,t as c,F as x,l as I,d as v,g,n as C,w as b,k as f,i as m,p as y,q as V,v as Y,e as G,s as P}from"./app-465a535e.js";import{_ as ct}from"./Header-b303769e.js";import{T as q,Z as ut,i as mt}from"./index.esm-7d1d6bea.js";import{_ as Z}from"./PrimaryButton-86823295.js";import{_ as z,a as X}from"./SecondaryButton-7f4f091b.js";import{E as J}from"./index-fb09ac7d.js";/* empty css            */import"./ApplicationLogo-bcd35d16.js";import"./NavLink-4a5e3780.js";const _t={class:"mt-10 p-2 md:w-9/12 m-auto"},pt={class:"md:p-10 md:border mb-5"},gt={class:"text-center text-xl font-bold"},ht={class:"text-right text-lg pt-5 pb-5"},ft={key:0},bt={style:{height:"70vh"}},vt=["src"],xt={key:1},yt={class:"mt-5 mb-5"},kt={class:"pt-5 pb-5 whitespace-pre-wrap text-center"},wt={class:"flex justify-between pt-2 border-t"},It={key:0},Ct={key:1},Pt={class:"flex flex-wrap justify-end"},Et={key:0},Vt={class:"m-5"},Ut={class:"mt-4 mb-4"},Rt=t("p",null,[t("strong",null,"座標:")],-1),Mt={class:"flex"},St={class:"mt-10 md:w-2/3 m-auto"},Tt=t("h3",{class:"mt-5 mb-10 text-xl font-bold"},"コメント一覧",-1),jt={key:0},zt={class:"border p-5"},Ft={class:"stars relative mb-4"},At=["checked"],Lt=t("label",null,"★",-1),Nt=["checked"],Kt=t("label",null,"★",-1),$t=["checked"],Bt=t("label",null,"★",-1),Ht=["checked"],Ot=t("label",null,"★",-1),Dt=["checked"],Yt=t("label",null,"★",-1),Gt={key:0},qt={class:"h-80 mb-5"},Zt=["src"],Xt={class:"pt-2 pb-4 text-xl font-bold"},Jt={class:"pt-2 pb-2"},Qt={class:"text-right text-lg pt-5 pb-5"},Wt={key:1,class:"flex flex-wrap justify-end"},te={class:"m-10 flex justify-center"},ee={class:"container mx-auto flex"},oe={class:"bg-white rounded-lg p-8 flex flex-col md:ml-auto w-full mt-10 md:mt-0 relative z-10 shadow-md"},se=t("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"記事を編集する",-1),le={key:0},ne={class:"m-3"},ae={class:"relative mb-4"},ie=t("label",{for:"title",value:"title",class:"leading-7 text-sm text-gray-600"},"Title",-1),de={class:"relative mb-4"},re=t("label",{for:"content",value:"content",class:"leading-7 text-sm text-gray-600"},"content",-1),ce={class:"flex mb-5"},ue=["disabled"],me=t("label",{for:" deleteImage",class:"leading-7 pr-3"},"登録済みの画像を削除",-1),_e=["disabled"],pe={key:1,class:"mt-2 mb-2"},ge={class:"mt-6 flex justify-end"},he={key:0},fe={key:1},be={class:"m-5"},ve={key:0,class:"mt-4 mb-4"},xe=t("p",null,[t("strong",null,"クリックした位置情報:")],-1),ye={class:"container mx-auto flex"},ke={class:"bg-white rounded-lg p-8 flex flex-col md:ml-auto w-full mt-10 md:mt-0 relative z-10 shadow-md"},we=t("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"コメントを投稿する",-1),Ie={key:0},Ce={class:"m-3"},Pe={class:"stars relative mb-4"},Ee={class:"form-stars"},Ve=t("label",{for:"star01"},"★",-1),Ue=t("label",{for:"star02"},"★",-1),Re=t("label",{for:"star03"},"★",-1),Me=t("label",{for:"star04"},"★",-1),Se=t("label",{for:"star05"},"★",-1),Te={class:"relative mb-4"},je=t("label",{for:"comment_title",value:"comment_title",class:"leading-7 text-sm text-gray-600"},"Title",-1),ze={class:"relative mb-4"},Fe=t("label",{for:"comment_content",value:"comment_content",class:"leading-7 text-sm text-gray-600"},"Content",-1),Ae={class:"flex mb-5"},Le=["disabled"],Ne=t("label",{for:"deleteImage",class:"leading-7 pr-3"},"登録済みの画像を削除",-1),Ke=["disabled"],$e={class:"mt-6 flex justify-end"},Je={__name:"Post-detail",props:{post:Object,user:Array,userId:Number,errors:Object,ownReview:Object,ownPost:Boolean,isFavorite:Boolean,favoriteId:Number},setup(r){const d=r,{VITE_GMAP_API_KEY:F}={VITE_PUSHER_APP_KEY:"",VITE_PUSHER_HOST:"",VITE_PUSHER_PORT:"443",VITE_PUSHER_SCHEME:"https",VITE_PUSHER_APP_CLUSTER:"mt1",VITE_GMAP_API_KEY:"AIzaSyBMN5q_xRCUrlFZf2jdYvlft75XVP1hYEw",BASE_URL:"/build/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},k=h(null),A=d.post.location.split(","),U=Number(A[0]),R=Number(A[1]),M=h({lat:U,lng:R}),L=h(16),_=h([]),N=h(!1),S=h(!1),T=h(!1);h(!1);const j=h(!1),s=q({post_id:d.post.id,user_id:d.userId,star:null,comment_title:null,comment_content:null,image:null,deleteImage:!1}),i=q({user_id:d.userId,status:d.post.status,title:d.post.title,content:d.post.content,image:d.post.image,deleteImage:!1,location:{lat:U,lng:R}}),K=()=>{d.user===null?f.Inertia.get(route("login")):(d.ownReview!=null&&(s.star=d.ownReview.star,s.comment_title=d.ownReview.comment_title,s.comment_content=d.ownReview.comment_content,N.value=!0),at())},Q=u=>{k.value={lat:u.latLng.lat(),lng:u.latLng.lng()}},W=()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(u=>{M.value={lat:u.coords.latitude,lng:u.coords.longitude}}):alert("Geolocation is not supported by this browser.")},tt=()=>{i.location=k.value,H()},et=()=>{d.user===null?f.Inertia.get(route("login")):d.isFavorite?f.Inertia.delete(route("favorite.destroy",d.favoriteId)):f.Inertia.post(route("favorite.store",{post_id:d.post.id,user_id:d.userId}))},ot=()=>{confirm("コメントを削除してよろしいですか？")&&(f.Inertia.delete(route("review.destroy",d.ownReview.id)),alert("コメントを削除しました")),w()},st=()=>{N.value?O()&&(f.Inertia.post(route("review.update",d.ownReview.id),{_method:"put",form:s}),alert("コメントを更新しました"),E()):O()&&(f.Inertia.post(route("review.store"),s),alert("コメントを投稿しました"),E())},lt=()=>{rt()&&(i.status=1,f.Inertia.post(route("post.update",d.post.id),{_method:"put",form:i}),alert("投稿を更新しました"),w())},nt=()=>{confirm("投稿を削除してよろしいですか？")&&(f.Inertia.delete(route("post.destroy",d.post.id)),alert("投稿を削除しました")),w()},$=u=>{const l=u.target.files[0];s.image=l},B=u=>{const l=u.target.files[0];i.image=l},at=()=>{S.value=!0},E=()=>{S.value=!1,s.reset()},it=()=>{j.value=!0},H=()=>{j.value=!1},dt=()=>{T.value=!0},w=()=>{T.value=!1,i.reset()},rt=()=>(_.value=[],i.title&&i.content&&i.location.lat?!0:(i.title||_.value.push("Titleは必須です"),i.content||_.value.push("Contentは必須です"),i.location.lat||_.value.push("位置の選択は必須です"),!1)),O=()=>(_.value=[],s.star&&s.comment_title&&s.comment_content?!0:(s.star||_.value.push("Starは必須です"),s.comment_title||_.value.push("Titleは必須です"),s.comment_content||_.value.push("Contentは必須です"),!1));return(u,l)=>(n(),a(x,null,[p(o(ut),{title:"Post-detail"}),p(ct,{authProps:d,page:"post-detail"},null,8,["authProps"]),t("div",_t,[t("article",pt,[t("h2",gt,"「"+c(r.post.title)+"」",1),t("h3",ht,c(r.post.user.name)+" さんの投稿",1),r.post.images.length?(n(),a("div",ft,[(n(!0),a(x,null,I(r.post.images,e=>(n(),a("div",{key:e.id},[t("div",bt,[t("img",{src:e.path,alt:"画像",class:"w-full h-full object-cover"},null,8,vt)])]))),128))])):(n(),a("div",xt," 画像なし ")),t("div",yt,[t("p",kt,c(r.post.content),1)]),t("div",wt,[t("div",null,"コメント: "+c(r.post.reviews_count)+"件",1),t("div",null,[v(" 評価: "),r.post.rating[0]?(n(),a("span",It,c(r.post.rating[0].avg_review),1)):(n(),a("span",Ct," 0.00 "))])]),t("div",Pt,[r.ownPost?(n(),a("button",{key:0,onClick:dt,class:"text-white bg-indigo-500 border-0 py-2 px-6 focus:outline-none hover:bg-indigo-600 rounded text-lg m-5 block"},"編集")):g("",!0),r.ownPost?(n(),a("button",{key:1,onClick:nt,class:"text-white bg-red-500 border-0 py-2 px-6 focus:outline-none hover:bg-indigo-600 rounded text-lg m-5 block"},"削除")):g("",!0)])]),r.post.location?(n(),a("div",Et,[p(o(J),{"api-key":o(F),style:{width:"100%",height:"450px"},center:M.value,zoom:L.value},null,8,["api-key","center","zoom"]),t("div",Vt,[t("div",Ut,[Rt,t("p",null,"緯度: "+c(o(U)),1),t("p",null,"経度: "+c(o(R)),1)])])])):g("",!0),t("div",Mt,[r.ownPost?g("",!0):(n(),a("button",{key:0,onClick:K,class:"text-white bg-indigo-500 border-0 py-2 px-6 focus:outline-none hover:bg-indigo-600 rounded text-lg ml-auto block"},"コメントする")),r.ownPost?g("",!0):(n(),a("button",{key:1,onClick:et},[t("a",{class:C(["unfavorite-star",{"favorite-star":d.isFavorite}])},"★",2)]))])]),t("div",St,[Tt,t("article",null,[r.post.reviews?(n(),a("div",jt,[(n(!0),a(x,null,I(r.post.reviews,e=>(n(),a("div",{key:e.id},[t("article",zt,[t("div",Ft,[t("span",null,[t("input",{class:"star5",type:"radio",checked:e.star==5},null,8,At),Lt,t("input",{class:"star4",type:"radio",checked:e.star==4},null,8,Nt),Kt,t("input",{class:"star3",type:"radio",checked:e.star==3},null,8,$t),Bt,t("input",{class:"star2",type:"radio",checked:e.star==2},null,8,Ht),Ot,t("input",{class:"star1",type:"radio",checked:e.star==1},null,8,Dt),Yt])]),e.images?(n(),a("div",Gt,[(n(!0),a(x,null,I(e.images,D=>(n(),a("div",{key:D.id},[t("div",qt,[t("img",{src:D.path,alt:"画像",class:"w-full h-full object-cover"},null,8,Zt)])]))),128))])):g("",!0),t("p",Xt,c(e.comment_title),1),t("p",Jt,c(e.comment_content),1),t("h3",Qt,c(e.user.name)+" さんの投稿",1),e.user_id==d.userId?(n(),a("div",Wt,[t("button",{onClick:K,class:"text-white bg-indigo-500 border-0 py-2 px-6 focus:outline-none hover:bg-indigo-600 rounded text-lg m-5 block"},"編集"),t("button",{onClick:ot,class:"text-white bg-red-500 border-0 py-2 px-6 focus:outline-none hover:bg-indigo-600 rounded text-lg m-5 block"},"削除")])):g("",!0)])]))),128))])):g("",!0)])]),t("div",te,[p(o(mt),{class:"text-white bg-indigo-500 border-0 py-2 px-6 focus:outline-none hover:bg-indigo-600 rounded text-lg",href:u.route("posts")},{default:b(()=>[v("投稿一覧へ")]),_:1},8,["href"])]),p(z,{show:T.value,onClose:w},{default:b(()=>[t("form",{onSubmit:G(lt,["prevent"])},[t("div",ee,[t("div",oe,[se,_.value.length?(n(),a("p",le,[t("ul",ne,[(n(!0),a(x,null,I(_.value,e=>(n(),a("li",{key:e,class:"text-red-500 list-disc mb-3"},c(e),1))),128))])])):g("",!0),t("div",ae,[ie,m(t("input",{id:"title","onUpdate:modelValue":l[0]||(l[0]=e=>o(i).title=e),type:"text",placeholder:"title",onKeyup:V(e=>!1,["enter"]),name:"title",maxlength:"20",class:"w-full bg-white rounded border border-gray-300 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 text-base outline-none text-gray-700 py-1 px-3 leading-8 transition-colors duration-200 ease-in-out"},null,544),[[y,o(i).title]])]),t("div",de,[re,m(t("textarea",{id:"content","onUpdate:modelValue":l[1]||(l[1]=e=>o(i).content=e),type:"textarea",placeholder:"content",onKeyup:V(e=>!1,["enter"]),name:"content",maxlength:"250",class:"w-full bg-white rounded border border-gray-300 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 h-32 text-base outline-none text-gray-700 py-1 px-3 resize-none leading-6 transition-colors duration-200 ease-in-out"},null,544),[[y,o(i).content]])]),t("div",ce,[t("div",null,[t("input",{id:"image",onChange:B,type:"file",placeholder:"image",name:"image",disabled:o(i).deleteImage},null,40,ue)]),t("div",null,[me,m(t("input",{id:"deleteImage","onUpdate:modelValue":l[2]||(l[2]=e=>o(i).deleteImage=e),onChange:B,type:"checkbox",name:"deleteImage",disabled:o(i).image,class:C({"opacity-25":o(i).image})},null,42,_e),[[Y,o(i).deleteImage]])])]),t("button",{onClick:it,class:"text-white bg-indigo-500 border-0 py-2 px-6 text-lg w-2/5",type:"button"},"位置を選択する"),o(i).location.lat?(n(),a("div",pe,[t("p",null,[v("緯度: "),m(t("input",{id:"location","onUpdate:modelValue":l[3]||(l[3]=e=>o(i).location.lat=e),type:"text",name:"location.lat",class:"border-none"},null,512),[[y,o(i).location.lat]])]),t("p",null,[v("経度: "),m(t("input",{id:"location","onUpdate:modelValue":l[4]||(l[4]=e=>o(i).location.lng=e),type:"text",name:"location.lng",class:"border-none"},null,512),[[y,o(i).location.lng]])])])):g("",!0),t("div",ge,[p(X,{onClick:w},{default:b(()=>[v(" Cancel ")]),_:1}),p(Z,{class:C(["ml-3",{"opacity-25":o(i).processing}]),disabled:o(i).processing},{default:b(()=>[d.post.status?(n(),a("span",he,"更新する")):(n(),a("span",fe,"投稿する"))]),_:1},8,["class","disabled"])])])])],32)]),_:1},8,["show"]),p(z,{show:j.value,onClose:H},{default:b(()=>[p(o(J),{ref:"mapRef","api-key":o(F),style:{width:"100%",height:"450px"},center:M.value,zoom:L.value,onClick:Q},null,8,["api-key","center","zoom"]),t("div",be,[t("button",{class:"block mb-5 border-b border-black",onClick:W},"現在地を取得する"),k.value?(n(),a("div",ve,[xe,t("p",null,"緯度: "+c(k.value.lat),1),t("p",null,"経度: "+c(k.value.lng),1)])):g("",!0),t("button",{onClick:tt,class:"text-white bg-indigo-500 border-0 py-2 px-6 focus:outline-none hover:bg-indigo-600 rounded text-lg"},"ここを選択する")])]),_:1},8,["show"]),p(z,{show:S.value,onClose:E},{default:b(()=>[t("form",{onSubmit:G(st,["prevent"])},[t("div",ye,[t("div",ke,[we,_.value.length?(n(),a("p",Ie,[t("ul",Ce,[(n(!0),a(x,null,I(_.value,e=>(n(),a("li",{key:e,class:"text-red-500 list-disc mb-3"},c(e),1))),128))])])):g("",!0),t("div",Pe,[t("span",Ee,[m(t("input",{id:"star01",type:"radio",name:"star",value:"5","onUpdate:modelValue":l[5]||(l[5]=e=>o(s).star=e)},null,512),[[P,o(s).star]]),Ve,m(t("input",{id:"star02",type:"radio",name:"star",value:"4","onUpdate:modelValue":l[6]||(l[6]=e=>o(s).star=e)},null,512),[[P,o(s).star]]),Ue,m(t("input",{id:"star03",type:"radio",name:"star",value:"3","onUpdate:modelValue":l[7]||(l[7]=e=>o(s).star=e)},null,512),[[P,o(s).star]]),Re,m(t("input",{id:"star04",type:"radio",name:"star",value:"2","onUpdate:modelValue":l[8]||(l[8]=e=>o(s).star=e)},null,512),[[P,o(s).star]]),Me,m(t("input",{id:"star05",type:"radio",name:"star",value:"1","onUpdate:modelValue":l[9]||(l[9]=e=>o(s).star=e)},null,512),[[P,o(s).star]]),Se])]),t("div",Te,[je,m(t("input",{id:"comment_title","onUpdate:modelValue":l[10]||(l[10]=e=>o(s).comment_title=e),type:"text",placeholder:"title",onKeyup:V(e=>!1,["enter"]),name:"comment_title",maxlength:"20",class:"w-full bg-white rounded border border-gray-300 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 text-base outline-none text-gray-700 py-1 px-3 leading-8 transition-colors duration-200 ease-in-out"},null,544),[[y,o(s).comment_title]])]),t("div",ze,[Fe,m(t("textarea",{id:"comment_content","onUpdate:modelValue":l[11]||(l[11]=e=>o(s).comment_content=e),type:"textarea",placeholder:"content",onKeyup:V(e=>!1,["enter"]),name:"comment_content",maxlength:"250",class:"w-full bg-white rounded border border-gray-300 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 h-32 text-base outline-none text-gray-700 py-1 px-3 resize-none leading-6 transition-colors duration-200 ease-in-out"},null,544),[[y,o(s).comment_content]])]),t("div",Ae,[t("div",null,[t("input",{id:"image",onChange:$,type:"file",placeholder:"image",name:"image",disabled:o(s).deleteImage},null,40,Le)]),t("div",null,[Ne,m(t("input",{id:"deleteImage","onUpdate:modelValue":l[12]||(l[12]=e=>o(s).deleteImage=e),onChange:$,type:"checkbox",name:"deleteImage",disabled:o(s).image,class:C({"opacity-25":o(s).image})},null,42,Ke),[[Y,o(s).deleteImage]])])]),t("div",$e,[p(X,{onClick:E},{default:b(()=>[v(" Cancel ")]),_:1}),p(Z,{class:C(["ml-3",{"opacity-25":o(s).processing}]),disabled:o(s).processing},{default:b(()=>[v(" 投稿する ")]),_:1},8,["class","disabled"])])])])],32)]),_:1},8,["show"])],64))}};export{Je as default};
