import{l as k,q as J,D as K,o as r,f as c,b as e,u as l,h as F,s as x,B as H,C as q,a as S,t as n,F as C,z as T,d as I,g as p,v as V,y as $,k as Z,W as z,p as ee,i as te,A}from"./app-e5ff0d44.js";import{H as oe,F as ae}from"./Footer-d216307d.js";import{_ as Q}from"./_plugin-vue_export-helper-c27b6911.js";import{T as se}from"./Toast-461c27d4.js";/* empty css            */const ne={class:"share-wrapper"},le=["href"],ie=["href"],re={__name:"ShareMenu",setup(b){const t=k(!1),m=window.location.href,f=encodeURIComponent(m),h=()=>{t.value=!t.value,console.log(t.value)},M=async()=>{try{await navigator.clipboard.writeText(m),alert("Link copied!"),t.value=!1}catch(v){console.error("Copy failed:",v)}},a=async()=>{if(navigator.share)try{await navigator.share({title:"Check out this Chill Spot!",url:m})}catch(v){console.error("Share canceled or failed:",v)}else alert("Your browser does not support native sharing.");t.value=!1},y=k(null),w=v=>{y.value&&y.value.contains(v.target)||v.target.closest(".share-wrapper")||(t.value=!1)};return J(()=>{document.addEventListener("click",w)}),K(()=>{document.removeEventListener("click",w)}),(v,U)=>(r(),c("div",ne,[e("button",{class:"btn share-btn",onClick:h},"Share"),t.value?(r(),c("div",{key:0,class:"share-popup",ref_key:"popup",ref:y},[e("a",{href:`https://x.com/share?url=${l(f)}&text=Check out this chill spot!`,target:"_blank",rel:"noopener noreferrer",class:"share-link"},"X",8,le),e("a",{href:`https://www.facebook.com/sharer/sharer.php?u=${l(f)}`,target:"_blank",rel:"noopener noreferrer",class:"share-link"},"Facebook",8,ie),e("button",{class:"share-link",onClick:M},"Copy Link"),e("button",{class:"share-link",onClick:a},"Native Share")],512)):F("",!0)]))}},ce=Q(re,[["__scopeId","data-v-9359d4d0"]]);const d=b=>(ee("data-v-e6b14c9b"),b=b(),te(),b),de={class:"container"},ue={class:"section"},ve={class:"spot-header"},_e={class:"category"},pe={class:"mb-4"},me=["src"],he={class:"spot-meta"},ge=d(()=>e("span",{class:"fw-bold"},"・ Address:",-1)),be=d(()=>e("span",{class:"fw-bold"}," ・ Best time:",-1)),fe=d(()=>e("span",{class:"fw-bold"}," ・ description:",-1)),ye={class:"buttons"},we={key:0,class:"text-end mt-3"},ke={key:1,class:"review-button-wrapper"},xe={key:0,class:"modal-backdrop-custom"},Se={class:"modal d-block",tabindex:"-1"},Ce={class:"modal-dialog modal-dialog-centered modal-lg"},Ve={class:"modal-content"},Fe=d(()=>e("h5",{class:"modal-title"},"Edit Post",-1)),Me={class:"modal-body"},Ue={class:"form-container"},Ee={class:"form-group"},De=d(()=>e("label",{for:"title"},"Title",-1)),Re={class:"form-group"},Te=d(()=>e("label",{for:"category"},"Category",-1)),Ie=A('<option value="cafe" data-v-e6b14c9b>Cafe</option><option value="park" data-v-e6b14c9b>Park</option><option value="beach" data-v-e6b14c9b>Beach</option><option value="Sauna" data-v-e6b14c9b>Sauna</option><option value="other" data-v-e6b14c9b>Other</option>',5),$e=[Ie],Ae={class:"form-group"},Be=d(()=>e("label",{for:"location_name"},"Location (Address)",-1)),Le={class:"address-container"},Ne={class:"form-group"},Pe=d(()=>e("label",{for:"visit-time"},"Recommended Visit Time",-1)),Oe=A('<option value="morning" data-v-e6b14c9b>Morning</option><option value="afternoon" data-v-e6b14c9b>Afternoon</option><option value="evening" data-v-e6b14c9b>Evening</option><option value="night" data-v-e6b14c9b>Night</option><option value="anytime" data-v-e6b14c9b>Anytime</option>',5),We=[Oe],He={class:"form-group"},qe=d(()=>e("label",{for:"description"},"Description",-1)),ze={class:"form-group"},Qe=d(()=>e("label",{for:"image-upload"},"Image Upload (Max:2MB)",-1)),Xe={class:"section review-section"},Ye=d(()=>e("h3",null,"Reviews",-1)),je={key:0},Ge={key:1,class:"review-summary"},Je={class:"review-header"},Ke={class:"review-text"},Ze={class:"review-form",id:"reviewForm"},et=["onUpdate:modelValue"],tt=A('<option value="5" data-v-e6b14c9b>⭐⭐⭐⭐⭐</option><option value="4" data-v-e6b14c9b>⭐⭐⭐⭐</option><option value="3" data-v-e6b14c9b>⭐⭐⭐</option><option value="2" data-v-e6b14c9b>⭐⭐</option><option value="1" data-v-e6b14c9b>⭐</option>',5),ot=[tt],at={class:"form-group"},st=d(()=>e("label",null,"Comment",-1)),nt={key:0,class:"text-danger"},lt={__name:"PostDetail",setup(b){var L,N,P,O,W;const t=x(()=>H().props.post),m=H().props.auth.user,f=k(null),h=k(!1);function M(){a.title=t.value.title,a.category=t.value.category,a.location_name=t.value.location_name,a.latitude=t.value.latitude,a.longitude=t.value.longitude,a.description=t.value.description,a.visit_time=t.value.visit_time,h.value=!0}const a=q({title:"",category:"",location_name:"",latitude:"",longitude:"",description:"",visit_time:"",status:"public",images:[]}),y=i=>{i.target.files.length?a.images=Array.from(i.target.files):a.images=[]};function w(){h.value=!1,a.reset()}function v(){console.log(a),a.post(route("posts.update",t.value.id),{forceFormData:!0,onSuccess:()=>{h.value=!1,location.reload()},onError:i=>{f.value.triggerToast(i,"error")}})}const U=x(()=>t.value.is_favorited),X=()=>{U.value?z.delete(route("favorite.destroy",t.value.id)):z.post(route("favorite.store",t.value.id))},B=x(()=>t.value.my_review!==null),E=k(!1),D=()=>{E.value=!E.value},u=q({post_id:t.value.id,rating_overall:((L=t.value.my_review)==null?void 0:L.rating_overall)||5,rating_silence:((N=t.value.my_review)==null?void 0:N.rating_silence)||5,rating_safety:((P=t.value.my_review)==null?void 0:P.rating_safety)||5,rating_relax:((O=t.value.my_review)==null?void 0:O.rating_relax)||5,comment:((W=t.value.my_review)==null?void 0:W.comment)||""}),Y=()=>{B.value?u.put(route("reviews.update",t.value.my_review.id),{onSuccess:()=>{D()},onError:i=>{console.error("Validation failed:",i)}}):u.post(route("reviews.store"),{onSuccess:()=>{D(),u.reset()},onError:i=>{console.error("Validation failed:",i)}})},g=x(()=>{const i=t.value.reviews;if(!i.length)return null;const s=o=>i.reduce((R,G)=>R+G[o],0)/i.length;return{overall:s("rating_overall"),relax:s("rating_relax"),safety:s("rating_safety"),silence:s("rating_silence")}}),_=i=>{const s=Math.floor(i),o=i%1>=.5?1:0;return"⭐".repeat(s)+(o?"☆":"")},j=i=>new Date(i).toLocaleDateString();return(i,s)=>(r(),c(C,null,[S(se,{ref_key:"toast",ref:f},null,512),S(oe),e("div",de,[e("div",ue,[e("div",ve,[e("h2",null,n(t.value.title),1),e("div",_e,n(t.value.category),1)]),e("div",pe,[(r(!0),c(C,null,T(t.value.images,o=>(r(),c("div",{key:o.id,class:"mb-3"},[e("img",{src:`/storage/${o.image_path}`,alt:"Post Image",class:"img-fluid w-100 rounded"},null,8,me)]))),128))]),e("div",he,[e("p",null,[ge,I(" "+n(t.value.location_name),1)]),e("p",null,[be,I(" "+n(t.value.visit_time),1)]),e("p",null,[fe,I(" "+n(t.value.description),1)])]),e("div",ye,[e("button",{class:"btn",onClick:X},n(U.value?"★":"☆"),1),S(ce)]),l(m)&&l(m).id===t.value.user_id?(r(),c("div",we,[e("button",{class:"btn",onClick:s[0]||(s[0]=o=>M())}," Edit ")])):(r(),c("div",ke,[e("button",{class:"btn",onClick:D},n(B.value?"Edit Review":"Leave a Review"),1)]))]),h.value?(r(),c("div",xe,[e("div",Se,[e("div",Ce,[e("div",Ve,[e("div",{class:"modal-header"},[Fe,e("button",{type:"button",class:"btn-close",onClick:w})]),e("div",Me,[e("div",Ue,[e("div",Ee,[De,p(e("input",{type:"text",id:"title","onUpdate:modelValue":s[1]||(s[1]=o=>l(a).title=o),placeholder:"e.g., Quiet Park"},null,512),[[V,l(a).title]])]),e("div",Re,[Te,p(e("select",{id:"category","onUpdate:modelValue":s[2]||(s[2]=o=>l(a).category=o)},$e,512),[[$,l(a).category]])]),e("div",Ae,[Be,e("div",Le,[p(e("input",{type:"text",id:"location_name","onUpdate:modelValue":s[3]||(s[3]=o=>l(a).location_name=o),placeholder:"e.g., Shibuya, Tokyo"},null,512),[[V,l(a).location_name]]),e("button",{class:"map-button",onClick:s[4]||(s[4]=o=>i.openMap())},"Select from Map")])]),e("div",Ne,[Pe,p(e("select",{id:"visit-time","onUpdate:modelValue":s[5]||(s[5]=o=>l(a).visit_time=o)},We,512),[[$,l(a).visit_time]])]),e("div",He,[qe,p(e("textarea",{id:"description","onUpdate:modelValue":s[6]||(s[6]=o=>l(a).description=o),placeholder:"Describe the charm of this spot"},null,512),[[V,l(a).description]])]),e("div",ze,[Qe,e("input",{type:"file",id:"image-upload",onChange:y},null,32)]),e("div",{class:"buttons mt-4"},[e("button",{type:"button",class:"btn cancel-btn",onClick:w},"Cancel"),e("button",{class:"btn",onClick:v},"Save Changes")])])])])])])])):F("",!0),e("div",Xe,[Ye,t.value.reviews.length?g.value?(r(),c("p",Ge," Overall: "+n(_(g.value.overall))+" ("+n(g.value.overall.toFixed(1))+") 【 Relax: "+n(_(g.value.relax))+" ・ Safety: "+n(_(g.value.safety))+" ・ Silence: "+n(_(g.value.silence))+" 】 ",1)):F("",!0):(r(),c("p",je,"No reviews yet.")),(r(!0),c(C,null,T(t.value.reviews,o=>(r(),c("div",{class:"review",key:o.id},[e("div",Je,n(o.user.name)+" - "+n(j(o.created_at)),1),e("p",null,"Overall "+n(_(o.rating_overall))+" 【 Relax: "+n(_(o.rating_relax))+" ・ Safety: "+n(_(o.rating_safety))+" ・ Silence: "+n(_(o.rating_silence))+" 】 ",1),e("p",Ke,n(o.comment),1)]))),128)),p(e("div",Ze,[(r(),c(C,null,T(["rating_overall","rating_relax","rating_safety","rating_silence"],o=>e("div",{class:"form-group",key:o},[e("label",null,n(o.replace("rating_","").charAt(0).toUpperCase()+o.replace("rating_","").slice(1)),1),p(e("select",{"onUpdate:modelValue":R=>l(u)[o]=R},ot,8,et),[[$,l(u)[o]]])])),64)),e("div",at,[st,p(e("textarea",{"onUpdate:modelValue":s[7]||(s[7]=o=>l(u).comment=o),rows:"4",placeholder:"Write your review...(max 500 characters)"},null,512),[[V,l(u).comment]])]),e("p",null,n(l(u).comment.length)+" / 500 characters",1),e("button",{class:"btn",onClick:Y},"Submit"),l(u).errors.comment?(r(),c("p",nt,n(l(u).errors.comment),1)):F("",!0)],512),[[Z,E.value]])])]),S(ae)],64))}},vt=Q(lt,[["__scopeId","data-v-e6b14c9b"]]);export{vt as default};
